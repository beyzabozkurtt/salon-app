<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Çalışma Saatleri</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <style>
    .day-label {
      width: 50px;
      font-weight: bold;
    }
    .section-title {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 20px;
    }
    .break-section {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 15px;
      margin-top: 30px;
    }
  </style>
</head>
<body class="p-4">
<div class="container mt-4">
  <h4 class="fw-bold mb-4">Çalışma saatleri</h4>
  <form id="working-hours-form">
    <!-- Günlük çalışma saatleri -->
    <div id="working-hours-list">
      <!-- Gün loop'u -->
      <script>
        const days = ['Pts', 'Sal', 'Çar', 'Per', 'Cum', 'Cts', 'Paz'];
        days.forEach(day => {
          document.write(`
            <div class="row align-items-center mb-3">
              <div class="col-md-1 fw-bold">${day}</div>
              <div class="col-md-2">
                <select class="form-select" name="isOpen-${day}">
                  <option value="true" selected>Açık</option>
                  <option value="false">Kapalı</option>
                </select>
              </div>
              <div class="col-md-2">
                <input type="time" class="form-control" name="startTime-${day}" value="09:00">
              </div>
              <div class="col-md-2">
                <input type="time" class="form-control" name="endTime-${day}" value="21:00">
              </div>
            </div>
          `);
        });
      </script>
    </div>

    <!-- Öğle arası mola saatleri -->
    <div class="bg-light p-3 rounded mt-4">
      <div class="mb-3 fw-semibold">— Öğle arası mola saatleri</div>
      <div id="break-hours-list">
        <script>
          days.forEach(day => {
            document.write(`
              <div class="row align-items-center mb-3">
                <div class="col-md-1 fw-bold">${day}</div>
                <div class="col-md-2">
                  <input type="time" class="form-control" name="breakStart-${day}" value="13:00">
                </div>
                <div class="col-md-2">
                  <input type="time" class="form-control" name="breakEnd-${day}" value="14:00">
                </div>
              </div>
            `);
          });
        </script>
      </div>
    </div>

    <button type="submit" class="btn btn-primary mt-4">Kaydet</button>
  </form>
</div>


  <!-- İsteğe bağlı JS -->
<script>
  

  document.getElementById("working-hours-form").addEventListener("submit", async function (e) {
    e.preventDefault();

    const data = days.map(day => {
      return {
        day,
        isOpen: document.querySelector(`[name="isOpen-${day}"]`).value === "true",
        startTime: document.querySelector(`[name="startTime-${day}"]`).value,
        endTime: document.querySelector(`[name="endTime-${day}"]`).value,
        breakStart: document.querySelector(`[name="breakStart-${day}"]`).value,
        breakEnd: document.querySelector(`[name="breakEnd-${day}"]`).value,
      };
    });

    try {
            const response = await fetch("http://localhost:5001/api/working-hours", {
            method: "PUT",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(data)
            });

      const result = await response.json();
      alert(result.message);
    } catch (err) {
      console.error("Hata:", err);
      alert("Bir hata oluştu.");
    }
  });
</script>

</body>
</html>
